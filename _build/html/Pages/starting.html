

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Começando &mdash; Neutron 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Neutron" href="../index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> Neutron
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Neutron Framework</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Começando</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#configurando-o-neutron">Configurando o Neutron</a></li>
<li class="toctree-l2"><a class="reference internal" href="#conexao-e-eventos">Conexão e Eventos</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Neutron</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Começando</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/Pages/starting.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="comecando">
<h1>Começando<a class="headerlink" href="#comecando" title="Permalink to this headline">¶</a></h1>
<p><strong>Instalação</strong></p>
<ul class="simple">
<li><p><em>Faça o download do Neutron no repositório:</em> <a class="reference external" href="https://github.com/RuanCardoso/Neutron-Unity-Network">https://github.com/RuanCardoso/Neutron-Unity-Network</a></p></li>
<li><p><em>Extraia o .zip, entre na pasta e renomeie a sub-pasta para “Neutron”</em></p></li>
</ul>
<img alt="../_images/subfolder_rename.png" class="img" src="../_images/subfolder_rename.png" />
<ul class="simple">
<li><p><em>Verifique se seu projeto possui o “Newtonsoft Json”, caso tenha-o instalado, pule este passo, caso não tenha o “Newtonsoft Json” instale o .unitypackage “JsonAutoInstaller” que se encontra dentro da pasta “Neutron”, este fará a instalação automática do “Newtonsoft Json” em seu projeto.</em></p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><em>Antes de instalar o Neutron é extremamente necessário instalar o “Newtonsoft Json” antes, caso contrário, você obterá erros de compilação. Observe que após a instalação do “Newtonsoft Json” o mesmo se encontrará na pasta “Packages” em vez de “Assets”</em></p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><em>As versões mais recentes da Unity, 2020 em diante, já possui o “Newtonsoft Json” instalado por padrão na pasta “Packages”, o mesmo se encontra na pasta “Packages” logo abaixo de “Assets”.</em></p>
</div>
<img alt="../_images/jsonautoinstaller.png" class="img" src="../_images/jsonautoinstaller.png" />
<ul>
<li><p><em>Agora que você já tem o pacote “Newtonsoft Json”, basta arrastar a pasta “Neutron” para a pasta “Assets” da Unity.</em></p>
<img alt="../_images/neutronfolderdrop.png" class="img" src="../_images/neutronfolderdrop.png" />
</li>
<li><p><em>Instalação concluída (:</em></p></li>
</ul>
<div class="section" id="configurando-o-neutron">
<h2>Configurando o Neutron<a class="headerlink" href="#configurando-o-neutron" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><em>Pressione “Alt+F11” para abrir as configurações do Neutron ou abra-o pelo menu “Neutron-&gt;Settings-&gt;File-&gt;Neutron”.</em></p></li>
</ul>
<img alt="../_images/config.png" class="img" src="../_images/config.png" />
<dl class="field-list simple">
<dt class="field-odd">Addresses</dt>
<dd class="field-odd"><p><em>A lista de endereços ip de servidores, o index 0 é usado por padrão.</em></p>
</dd>
<dt class="field-even">Port</dt>
<dd class="field-even"><p><em>A porta Tcp que será utilizado para estabelecer a conexão com os servidores.</em></p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><em>Não se esqueça de liberar a porta Tcp no Firewall e no Gerenciamento de Portas do seu Cloud(Google, Amazon, Azure…etc), no caso do Udp, você deve liberar todas as portas Udp, exceto as portas exclusivas para outras aplicações, a fim de evitar vulnerabilidades.</em></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">AppId</dt>
<dd class="field-odd"><p><em>Usado para identificar a versão do seu Jogo.</em></p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><em>Se o AppId do cliente é diferente do AppId do servidor a conexão será rejeitada, útil para impedir que versões antigas se conectem ao servidor. Antes de compilar as duas versões(Client e Servidor) é recomendado que gere um novo AppId.</em></p>
</div>
<img alt="../_images/genappid.png" class="img" src="../_images/genappid.png" />
<dl class="field-list simple">
<dt class="field-odd">Fps</dt>
<dd class="field-odd"><p><em>Limita o Fps da compilação atual.</em></p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><em>O SendRate(Taxa de Envio) é limitado ao fps do jogo, ex: se o fps atual é 30, e o SendRate está definido em 128 vezes por segundo, o SendRate será limitado a 30 vezes por segundo, resumindo, o SendRate não pode ser maior que a taxa de fps, é limitado automaticamente.</em></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Pool Capacity</dt>
<dd class="field-odd"><p><em>Stream and Packet Pool Capacity, isto é, a quantidade de objetos pré-inicializados para uso e a quantidade máxima de objetos no pool.</em></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><em>“Stream pool”, reutilizará “streams” para escrever novamente na rede, o mesmo para “Packet Pool” que reutilizará pacotes. Quanto maior o SendRate mais objetos serão retirados do pool. ex: uma Taxa de 64 vezes por segundo vai precisar de uma capacidade maior no pool, caso contrário, haverá estouros, em caso de estouros, um novo objeto será criado para evitar que seu servidor pare de funcionar, a criação de novos objetos gera alocações no GC.</em></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Serialization</dt>
<dd class="field-odd"><p><em>O tipo de serialização que será usado para transformar um objeto em um fluxo de dados para ser enviado via rede.</em></p>
</dd>
<dt class="field-even">Compression</dt>
<dd class="field-even"><p><em>O tipo de compressão de dados que será usado para compactar os dados enviados via rede</em></p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><em>Observe que compressão de dados aumenta o uso de Cpu, pois os mesmos devem ser compactado antes de enviar e descompactado após chegar ao destino.</em></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">NoDelay</dt>
<dd class="field-odd"><p><em>Obtém ou define um valor que desabilita um atraso ao enviar ou receber buffers que não estão cheios.</em></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><em>Quando NoDelay é false, a rede não envia um pacote até que ele tenha coletado uma quantidade significativa de dados de saída. Devido à quantidade de sobrecarga em um segmento TCP, o envio de pequenas quantidades de dados é ineficiente. No entanto, existem situações em que você precisa enviar quantidades muito pequenas de dados ou esperar respostas imediatas de cada pacote enviado. Sua decisão deve avaliar a importância relativa da eficiência da rede em relação aos requisitos do aplicativo.</em></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">PingRate</dt>
<dd class="field-odd"><p><em>Medido em segundos, é enviado em X segundos um pacote de manuntenção Udp pro servidor.</em></p>
</dd>
<dt class="field-even">TcpKeepAlive</dt>
<dd class="field-even"><p><em>Medido em segundos, é enviado em X segundos um pacote de manuntenção Tcp pro servidor.</em></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><em>Os pacotes de manuntenção são enviados com a única finalidade de manter a conexão ativa.</em></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Backlog</dt>
<dd class="field-odd"><p><em>A quantidade máxima de conexões em espera na fila.</em></p>
</dd>
<dt class="field-even">Container Name</dt>
<dd class="field-even"><p><em>O nome da cena(scene) do cliente.</em></p>
</dd>
<dt class="field-odd">Max Udp Packet Size</dt>
<dd class="field-odd"><p><em>O tamanho máximo do pacote Udp que pode ser enviado ou recebido.</em></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><em>Max Udp Packet Size, recomendo o valor de 512 bytes, este valor não excede o valor MTU mínimo, logo as chances do pacote ser fragmentado é zero. Quanto maior o tamanho do pacote Udp, maior são as chances do pacote ser fragmentado ao longo do caminho, isto porque, corre o risco de ao longo do caminho o tamanho exceder o MTU de algum router. Neutron não suporta a fragmentação de pacotes Udp.</em></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Max Tcp Packet Size</dt>
<dd class="field-odd"><p><em>O tamanho máximo do pacote Tcp que pode ser enviado ou recebido.</em></p>
</dd>
<dt class="field-even">Receive Buffer Size</dt>
<dd class="field-even"><p><em>Define o número de bytes que você espera armazenar no buffer de recebimento para cada operação de leitura.</em></p>
</dd>
<dt class="field-odd">Send Buffer Size</dt>
<dd class="field-odd"><p><em>Define o número de bytes que você espera enviar em cada chamada para a rede.</em></p>
</dd>
<dt class="field-even">Max Connections Per Ip</dt>
<dd class="field-even"><p><em>Define a quantidade máxima que o mesmo Ip pode se conectar ao servidor.</em></p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><em>Max Connections Per Ip, pode ser usado para limitar quantos jogos podem ser aberto na mesma rede. Ex: se o valor ser 1, somente um jogo pode ser aberto na mesma rede, outra instância do jogo será desconectada.</em></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Max Latency</dt>
<dd class="field-odd"><p><em>A latência máxima tolerada pelo servidor.</em></p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><em>Qualquer valor que excede Max Latency, o servidor irá acionar o evento “OnMaxLatencyReached”. Ex: dentro do evento você pode enviar a ação de desconectar, expulsar ou qualquer outra ação.</em></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Time Desync Tolerance</dt>
<dd class="field-odd"><p><em>O tempo máximo em segundos que o servidor tolera de dessincronização do cliente.</em></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><em>Ex: Time Desync Tolerance é 1, isto é, o servidor tolera que o cliente esteja 1 segundo atrasado, se exceder, o evento “OnDesyncToleranceReached” será acionado.</em></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Time Resync Tolerance</dt>
<dd class="field-odd"><p><em>Medido em segundos, define a tolerância de ressincronização.</em></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><em>Ex: Time Resync Tolerance: é 0.001, isto é, se a diferença do tempo do servidor e do cliente é maior que o valor definido, o tempo será ressincronizado.</em></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Receive Model</dt>
<dd class="field-odd"><p><em>Define se o modo de recebimento dos dados é sincrono ou assíncrono.</em></p>
</dd>
<dt class="field-even">Send Model</dt>
<dd class="field-even"><p><em>Define se o modo de enviar os dados é sincrono ou assíncrono.</em></p>
</dd>
<dt class="field-odd">Async Pattern</dt>
<dd class="field-odd"><p><em>Define os padrões para a execução de operações assíncronas.</em></p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><em>O modelo de envio Async e o padrão Tap, é recomendado o uso em caso de baixa frêquencia de envio e recebimento de dados, estes, geram muita alocaçãos no GC e alto uso de CPU. A configuração padrão é ideal para todos os casos de uso.</em></p>
</div>
<p><em>Modelo Tap</em>:</p>
<div class="highlight-C# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">Task</span> <span class="nf">Test</span><span class="p">()</span> <span class="p">{</span>
   <span class="k">return</span> <span class="k">new</span> <span class="nf">Task</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p><em>Modelo Apm</em>:</p>
<div class="highlight-C# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">void</span> <span class="nf">BeginTest</span><span class="p">()</span> <span class="p">{</span>

<span class="p">}</span>

<span class="k">void</span> <span class="nf">EndTest</span><span class="p">()</span> <span class="p">{</span>

<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<dl class="field-list simple">
<dt class="field-odd">Encoding</dt>
<dd class="field-odd"><p><em>Define o tipo de codificação para o processo de transformar um conjunto de caracteres em uma sequência de bytes.</em></p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><em>Esta propriedade pode causar o aumento exponencial do uso de largura de banda.</em></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Header Size</dt>
<dd class="field-odd"><p><em>Define o tipo de primitivo que será usado para armazenar o tamanho da mensagem no cabeçalho do pacote.</em></p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><em>Esta propriedade pode causar o aumento exponencial do uso de largura de banda.</em></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Buffered Stream</dt>
<dd class="field-odd"><p><em>Adiciona uma camada de armazenamento em buffer para ler e gravar operações em outro fluxo.</em></p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><em>O uso de BufferedStream aumenta em até dez vezes o desempenho sobre operações E/S no socket Tcp.</em></p>
</div>
<p><strong>Synchronization</strong></p>
<ul class="simple">
<li><p><em>Pressione “Alt+F10” para abrir as configurações de Sincronização ou abra-o pelo menu “Neutron-&gt;Settings-&gt;File-&gt;Synchronization”.</em></p></li>
</ul>
<p><em>Aqui você pode personalizar o alvo de alguns pacotes internos do Neutron.</em></p>
<dl class="field-list simple">
<dt class="field-odd">TargetTo</dt>
<dd class="field-odd"><p><em>Define os alvos de recepção do pacote.</em></p>
</dd>
<dt class="field-even">Tunneling To</dt>
<dd class="field-even"><p><em>Define o túnel onde os dados devem ser tunelados.</em></p>
</dd>
<dt class="field-odd">Protocol</dt>
<dd class="field-odd"><p><em>O protocolo que será usado para transmitir o pacote via rede.</em></p>
</dd>
</dl>
<img alt="../_images/syncconfig.png" class="img" src="../_images/syncconfig.png" />
</div>
<div class="section" id="conexao-e-eventos">
<h2>Conexão e Eventos<a class="headerlink" href="#conexao-e-eventos" title="Permalink to this headline">¶</a></h2>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><em>Muitos metódos e eventos possui o último parâmetro do tipo “Neutron”, este parâmetro é a instância que chamou o metódo ou evento.</em></p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><em>Muitos metódos e eventos possui o parâmetro do tipo “bool” chamado de “isMine”, este parâmetro retorna se o “Player” passado como parâmetro é seu.</em></p>
</div>
<p><em>Para começamos com Neutron é muito simples:</em></p>
<ul class="simple">
<li><p><em>Primeiro iremos criar uma instância de Neutron.</em></p></li>
</ul>
<div class="highlight-C# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">Neutron</span> <span class="n">neutron</span> <span class="p">=</span> <span class="n">Neutron</span><span class="p">.</span><span class="n">Create</span><span class="p">(</span><span class="n">ClientMode</span><span class="p">.</span><span class="n">Player</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p><em>Observe que o metódo</em> <strong>Neutron.Create()</strong> <em>leva 1 argumento opcional:</em></p>
<dl class="field-list simple">
<dt class="field-odd">ClientMode.Player</dt>
<dd class="field-odd"><p><em>Define que está instância será a instância principal</em>.</p>
</dd>
<dt class="field-even">ClientMode.Virtual</dt>
<dd class="field-even"><p><em>Cria uma instância que não é a instância principal</em>.</p>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><em>A instância principal é acessível através da propriedade estática “Neutron.Client”.</em></p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><em>A instância virtual pode ser usada para simular jogadores e outras ações.</em></p>
</div>
<ul class="simple">
<li><p><em>Agora vamos registrar os eventos da instância.</em></p></li>
</ul>
<p><em>Neutron tem alguns eventos ao lado do cliente, sendo eles.</em></p>
<div class="highlight-C# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">neutron</span><span class="p">.</span><span class="n">OnNeutronConnected</span> <span class="p">+=</span> <span class="n">OnNeutronConnected</span><span class="p">;</span>
<span class="n">neutron</span><span class="p">.</span><span class="n">OnPlayerConnected</span> <span class="p">+=</span> <span class="n">OnPlayerConnected</span><span class="p">;</span>

<span class="c1">//Este evento é acionado quando uma tentativa de conexão retorna seu estado.</span>
<span class="c1">//isSuccess: Retorna se a tentativa de conexão foi bem sucedida.</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">OnNeutronConnected</span><span class="p">(</span><span class="kt">bool</span> <span class="n">isSuccess</span><span class="p">,</span> <span class="n">Neutron</span> <span class="n">neutron</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">//* Faça algo.</span>
<span class="p">}</span>


<span class="k">private</span> <span class="k">void</span> <span class="nf">OnPlayerConnected</span><span class="p">(</span><span class="n">NeutronPlayer</span> <span class="n">player</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">isMine</span><span class="p">,</span> <span class="n">Neutron</span> <span class="n">neutron</span><span class="p">)</span>
<span class="p">{</span>

<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="../index.html" class="btn btn-neutral float-left" title="Neutron" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Ruan Cardoso

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>